---
title: "静态博客搭建日记"
date: 2021-12-06T18:36:56+08:00
categories:
  - tech
tags:
  - hugo
  - blog
description: 本站的第一篇post。
---
> 本文在[Craft](https://www.craft.do)上撰写并更新。为了最佳阅读体验，请访问以下链接：
>  
> - 原文：<https://www.craft.do/s/xOgdBuUQQzkhQg>

买了新域名[pieris05.com](https://pieris05.com)，手痒，想搭blog。折腾Wordpress良久，发现维护起来确实麻烦，总会有奇奇怪怪的小bug。最终决定搭建静态博客。选择了[Hugo](https://gohugo.io)，与个人主页一样部署在[Cloudflare Pages](https://pages.dev/)。

另外，在Obsidian, Notion等等笔记软件之间兜兜转转之后，终于发现了心仪的软件[Craft](https://www.craft.do)，它的导出功能既方便又好看。同时决定不再折腾博客，以后的发布流程如下：

> 在Craft写文→使用Craft导出工具导出markdown, PDF, web →将markdown导入到博客，提供web链接并鼓励访问该链接，PDF作为存档。
---

搭建过程参考了小球飞鱼的博客，基本把需要注意的点全部写出来了。

链接：[https://mantyke.icu/2021/hugo-build-blog/](https://mantyke.icu/2021/hugo-build-blog/)

存档：[https://archive.ph/lXsBy](https://archive.ph/lXsBy)

## 踩过的坑

### 未指定Hugo版本号导致报错

Cloudflare Pages报错`function "warnf" not defined` ，Google后发现以下页面：

[Vercel 部署失败，提示：lunr-search.html:8: function "warnf" not defined · Issue #244 · reuixiy/hugo-theme-meme](https://github.com/reuixiy/hugo-theme-meme/issues/244)

其中有人指出，报错是因为Hugo版本配置错误。配制方法如下：

> ### [Framework Versioning](https://vercel.com/docs/concepts/deployments/build-step?query=hugo#framework-versioning)

> Some frameworks do not use `package.json` to select a specific version to install during build time.

> By including an [Environment Variable](https://vercel.com/docs/concepts/projects/environment-variables), you can define your framework's version with one of the following:

| **Framework** | **Environment Variable Name** |
| ------------- | ----------------------------- |
| Hugo          | `HUGO_VERSION`                |
| Zola          | `ZOLA_VERSION`                |

> For example, to select Hugo v0.61.0 you would add an Environment Variable named `HUGO_VERSION` with value `0.61.0`.

> **Note:** The value must match an existing GitHub Release with an attached asset. For example, Hugo `0.42.0` does not exist but Hugo `0.42` does exist.

一顿折腾、配制好之后才发现，原来小球飞鱼的博客上写了这一步(╯﹏╰）可恶，以后还是得认真看人家的技术博客。

### clone的主题包含`.git` 文件夹导致push失败

根据主题的教程，将repo clone到themes文件夹后，push时会略过这个文件夹。查看隐藏文件发现，主题文件夹内包含了`.git` , `.gitignore` , `.github` 三个隐藏文件。悉数删去后再push就没有任何问题了( ´▽｀)

后来发现可以使用submodule，便于更新主题。配置方法如下：

> you can use as [submodule](https://www.atlassian.com/git/tutorials/git-submodule) with

```Bash
git submodule add [https://github.com/adityatelange/hugo-PaperMod.git](https://github.com/adityatelange/hugo-PaperMod.git) themes/PaperMod --depth=1
git submodule update --init --recursive # needed when you reclone your repo (submodules may not get cloned automatically)
```

> **Note**: You may use `--branch v5.0` to end of above command if you want to stick to specific release.

> Updating theme :

> `git submodule update --remote --merge`
